@{
    /**/

    ViewBag.Title = "Add_User_Roles";
    Layout = "~/Views/Shared/_LayoutV2.cshtml";

    Func<string, string, string> T = (key, fallback) =>
    {
        try
        {
            var o = HttpContext.GetGlobalResourceObject("UserRoles", key);
            return (o == null) ? fallback : o.ToString();
        }
        catch { return fallback; }
    };
}

<div class="ur-page">
    <div class="ur-shell">

        <!-- Header (Account-style) -->
        <div class="ur-header">
            <div>
                <div class="ur-title">@T("Add_Title", "Add User Roles")</div>
                <div class="ur-sub">@T("SubTitle", "Manage user roles and permissions")</div>
            </div>

            <div class="ur-actions-top">
                <a class="btn btn-outline-secondary ur-btn-top" href="@Url.Action("Index","ProviderUserDatas")">
                    <i class="bi bi-arrow-left"></i>
                    <span>@T("Btn_BackHome", "Back to Home")</span>
                </a>

                <a class="btn btn-outline-success ur-btn-top" href="@Url.Action("Edit_User_Roles","ProviderUserDatas")">
                    <i class="bi bi-pencil-square"></i>
                    <span>@T("Edit_Title", "Edit User Roles")</span>
                </a>
            </div>
        </div>

        <!-- ✅ IMPORTANT: enable jQuery bundle (was commented) -->
        @Scripts.Render("~/bundles/jquery")
        @Scripts.Render("~/bundles/bootstrap")
        <script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
        <script src="~/signalr/hubs" type="text/javascript"></script>

        <link rel="stylesheet" href="~/Content/select2.min.css">
        <script type="text/javascript" src="~/Scripts/select2.min.js"></script>
        <script type="text/javascript" src="~/Scripts/moment-with-locales.min.js"></script>

        @Html.Hidden("Get", Url.Action("Get", "Customer"))
        @Html.Hidden("Getmessages", Url.Action("Getmessages", "Customer"))
        @Html.Hidden("Get1", Url.Action("Get1", "Customer"))

        <input type="hidden" id="trigger" value="0" />
        <input type="hidden" id="triggercount" value="0" />

        <input type="hidden" id="trigger1" value="0" />
        <input type="hidden" id="triggercount1" value="0" />
        <input type="hidden" id="providerCatId" value="@ViewBag.providerCatId" />

        <!-- ===== your original styles (unchanged) ===== -->
        <style>

            #link {
                text-decoration: none;
                display: inline-block;
                padding: 8px 16px;
            }

                #link:hover {
                    background-color: #ddd;
                    color: black;
                }

            .round {
                background-color: teal;
                color: white;
                border-radius: 50%;
            }
        </style>
        <style>
            #User_list {
                max-width: 450px;
            }

            body {
                font-family: Arial;
                font-size: 10pt;
            }

            table {
                border: 1px solid #ccc;
                border-collapse: collapse;
                background-color: #fff;
                text-align: center;
            }

                table th {
                    background-color: teal;
                    color: white;
                    font-weight: bold;
                    font-size: 24px;
                    text-align: center;
                }

                table th, table td {
                    padding: 5px;
                    border: 1px solid #ccc;
                }

                table, table table td {
                    border: 0px solid #ccc;
                    color: black;
                    font-size: 20px;
                }

            legend.scheduler-border {
                width: inherit; /* Or auto */
                padding: 0 10px; /* To give a bit of padding on the left and right */
                border-bottom: none;
            }

            fieldset.scheduler-border {
                border: 1px groove #ddd !important;
                padding: 0 1.4em 1.4em 1.4em !important;
                margin: 0 0 1.5em 0 !important;
                -webkit-box-shadow: 1px 1px 1px 1px #700c0c;
                box-shadow: 1px 1px 1px 1px #700c0c;
            }

            .ul.pagination {
                display: inline-block;
                padding: 0;
                margin: 0;
            }

            ul.pagination li {
                display: inline;
            }

                ul.pagination li a {
                    color: black;
                    float: left;
                    padding: 8px 16px;
                    text-decoration: none;
                    transition: background-color .3s;
                }

                    ul.pagination li a.active {
                        background-color: #4CAF50;
                        color: white;
                    }

                    ul.pagination li a:hover:not(.active) {
                        background-color: #ddd;
                    }
        </style>

        <!-- ===== content ===== -->
        <fieldset class="scheduler-border ur-fieldset">
            <legend class="scheduler-border" style="color:teal">@T("Section_RolesData", "Users Roles Data")</legend>

            <br />
            <br />
            <div class="container ur-toolbar" style="text-align:center;background:#e2dede;width:1115px;height:70px">
                <br />
                <p>
                    <label style="color:black;width:100px;font-size:18px;">@T("UsersList", "Users list")</label> &nbsp;
                    @Html.DropDownList("Citydropdown1", new SelectList(ViewBag.li), @T("SelectUser", "----Select User Name----"), htmlAttributes: new { @class = "form-control", @id = "User_list", @Name = "User_list" })
                </p>

            </div>
            <br />

            <div class="table-responsive ur-table-wrap">
                <table class="table" id="tblUser_Roles" cellpadding="0" cellspacing="0">
                    <thead class="table-dark">

                    </thead>
                    <tr>
                        <th>@T("RoleName", "Role Name")</th>
                        <th>@T("IsChecked", "IsChecked")</th>

                    </tr>
                    <tbody>

                        <tr>
                            <td style="color:cadetblue;">@T("SelectAllPages", "Select All Pages")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="select_all"><label style="background-color:white" for="select_all" class="check-box"></label></div>
                            </td>

                        </tr>

                        <tr id="UMC">
                            <td>@T("UploadMemberClaim", "Upload Member Claim")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="UploadMember_Claim"><label style="background-color:white" for="UploadMember_Claim" class="check-box"></label></div>
                            </td>
                        </tr>

                        <tr id="MS">
                            <td>@T("MedicalServices", "Medical Services")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Medical_Services"><label style="background-color:white" for="Medical_Services" class="check-box"></label></div>
                            </td>

                        </tr>
                        <tr id="CA">
                            <td>@T("ClaimFormApproved", "ClaimForm Approved")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="ClaimForm_Approved"><label style="background-color:white" for="ClaimForm_Approved" class="check-box"></label></div>
                            </td>

                        </tr>
                        <tr id="A">
                            <td>@T("Approval", "Approval")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Approval"><label style="background-color:white" for="Approval" class="check-box"></label></div>
                            </td>

                        </tr>
                        <tr id="ES">
                            <td>@T("ExpandedServices", "Expanded Services")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Expanded_Services"><label style="background-color:white" for="Expanded_Services" class="check-box"></label></div>
                            </td>

                        </tr>
                        <tr id="PI">
                            <td>@T("PaymentInquiry", "Payment Inquiry")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Payment_Inquiry"><label style="background-color:white" for="Payment_Inquiry" class="check-box"></label></div>
                            </td>

                        </tr>
                        <tr id="IA">
                            <td>@T("InvoicesAudit", "Invoices Audit")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Invoices_Audit"><label style="background-color:white" for="Invoices_Audit" class="check-box"></label></div>
                            </td>
                        </tr>
                        <tr id="Dc">
                            <td>@T("DoctorClaimForm", "Doctor ClaimForm")</td>
                            <td>
                                <div class="checkbox-wrapper-19"><input type="checkbox" id="Doctor_ClaimForm"><label style="background-color:white" for="Doctor_ClaimForm" class="check-box"></label></div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <br />
            <br />
            <div class="btn-lg ur-btn-row" style="text-align:center">
                <input type="submit" value="@T("Btn_Create","Create")" id="User_role" class="btn btn-primary btn-lg btn-block ur-action-btn" />
            </div>

            <div class="ur-footer-links">
                <a id="link" class="round" href="@Url.Action("Index","ProviderUserDatas")">&laquo; @T("Btn_BackHome", "Back to Home")</a>
                <a id="link" class="round" href="@Url.Action("Edit_User_Roles","ProviderUserDatas")">@T("Edit_Title", "Edit User Roles") &raquo;</a>
            </div>
        </fieldset>

    </div>
</div>

@if (ViewBag.providerCatId != null)
{
    <script type="text/javascript">

            window.onload = function () {
                if (( "@ViewBag.providerCatId" == 1) || ( "@ViewBag.providerCatId" == 5) || ( "@ViewBag.providerCatId" == 6) || ( "@ViewBag.providerCatId" == 7)) {
                    $("#UMC").hide();
                    $("#MS").hide();
                    $("#CA").hide();
                    $("#A").hide();

                }
                else {
                    $("#Dc").hide();
                }
            };
    </script>
}

<script type="text/javascript">
    $(document).ready(function () {

        $("#User_list").select2();
        //alert($('#providerCatId').val());

        $("body").on("click", "#User_role", function () {
            //alert($('#Cliams_Booklet').is(":checked"));
            $.get("/ProviderUserDatas/Add_User_Roless", {
                User_list: $('#User_list').val(),
                UploadMember_Claim: $('#UploadMember_Claim').is(":checked"),
                Medical_Services: $('#Medical_Services').is(":checked"),
                ClaimForm_Approved: $('#ClaimForm_Approved').is(":checked"),
                Approval: $('#Approval').is(":checked"),
                Expanded_Services: $('#Expanded_Services').is(":checked"),
                Payment_Inquiry: $('#Payment_Inquiry').is(":checked"),
                Invoices_Audit: $('#Invoices_Audit').is(":checked"),
                Doctor_ClaimForm: $('#Doctor_ClaimForm').is(":checked")
            }, function (data) {

                if (data[0] == 0) {

                    $('#User_list')
                        .find('option')
                        .remove()
                        .end()
                        .append('<option value="whatever">----Select User Name----</option>')
                        .val('whatever')
                        ;
                    var select = document.getElementById("User_list"), data;


                    for (var i = 0; i < data[1].length; i++) {
                        var opt = document.createElement("option");

                        txt = document.createTextNode(data[1][i]);
                        opt.appendChild(txt);
                        opt.setAttribute("value", data[1][i]);
                        select.insertBefore(opt, select.lastChild);

                    }

                    Swal.fire("Success", "User Roles is Added Successfully", "success");

                }
                else {
                    Swal.fire("Error !", data[1], "error");

                }
            })
        });

        $("#select_all").change(function () {

            if ($('#select_all').is(":checked") != false) {

                if (($('#providerCatId').val() == 1) || ($('#providerCatId').val() == 5) || ($('#providerCatId').val() == 6) || ($('#providerCatId').val() == 7)) {
                    $("#Expanded_Services").prop('checked', true);
                    $("#Payment_Inquiry").prop('checked', true);
                    $("#Invoices_Audit").prop('checked', true);
                    $("#Doctor_ClaimForm").prop('checked', true);
                }
                else {
                    $("#UploadMember_Claim").prop('checked', true);
                    $("#Medical_Services").prop('checked', true);
                    $("#ClaimForm_Approved").prop('checked', true);
                    $("#Approval").prop('checked', true);
                    $("#Expanded_Services").prop('checked', true);
                    $("#Payment_Inquiry").prop('checked', true);
                    $("#Invoices_Audit").prop('checked', true);
                }
            }
            else {
                if (($('#providerCatId').val() == 1) || ($('#providerCatId').val() == 5) || ($('#providerCatId').val() == 6) || ($('#providerCatId').val() == 7)) {

                    $("#Expanded_Services").prop('checked', false);
                    $("#Payment_Inquiry").prop('checked', false);
                    $("#Invoices_Audit").prop('checked', false);
                    $("#Doctor_ClaimForm").prop('checked', false);
                }
                else {
                    $("#UploadMember_Claim").prop('checked', false);
                    $("#Medical_Services").prop('checked', false);
                    $("#ClaimForm_Approved").prop('checked', false);
                    $("#Approval").prop('checked', false);
                    $("#Expanded_Services").prop('checked', false);
                    $("#Payment_Inquiry").prop('checked', false);
                    $("#Invoices_Audit").prop('checked', false);
                }
            }
        });

    });

</script>
<script type="text/javascript">
    $(document).on('select2:open', () => {
        document.querySelector('.select2-search__field').focus();
    });
</script>


<script type="text/javascript">
    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            $.connection.hub.stop();
        } else {
            $.connection.hub.start().done(function () {
                getData();
                getData1();
            }).fail(function (e) {
            });
        }
    });

    function sleep(ms) {
        return new Promise(
            resolve => setTimeout(resolve, ms)
        );
    }
    $(function () {

        // Proxy created on the fly
        var cus = $.connection.cusHub;

        cus.client.displayCustomer = function () { getData(); };
        cus.client.data = function () { getData1(); };
        cus.client.data1 = function () { getData2(); };

        $.connection.hub.start();
        getData();
        getData1();
        getData2();

    });

    function getData1() {
        try {

            $.ajax({
                url: $("#Getmessages").val(),
                type: 'GET',
                datatype: 'json',
                success: function (data1) {

                    $.get("/ClaimForm/getcountmessage", {}, function (data) {
                        setBadgeCount('MesaageCount', data);
                    });

                    $.each(data1.listCus, function (i, model) { });
                }
            });
        }
        catch (err) { }
    }

    function getData() {
        try {

            $.ajax({
                url: $("#Get").val(),
                type: 'GET',
                datatype: 'json',
                success: function (data) {

                    var provid = 0;
                    var branchid = 0;
                    if ("@Session["providerid"]" != "" && "@Session["BranchID"]" != "") {
                        provid = parseInt("@Session["providerid"]");
                        branchid = parseInt("@Session["BranchID"]");
                    }
                    var ApprovePage = 0;

                    if ("@Session["ClaimForm_Approved"]" != "") {
                        ApprovePage = parseInt("@Session["ClaimForm_Approved"]");
                    }

                    $.get("/ClaimForm/getcountallert", {}, function (data1) {
                        setBadgeCount('NotifactionCount', data1);
                    });

                    $.each(data.listCus, function (i, model) {

                        if ((provid == model.ProviderID) && (branchid == model.BranchID) && (model.CardNumber != "0") && (model.ClaimFormNum != 0) && ($('#trigger').val() == "0") && (ApprovePage == 1)) {
                            $('#trigger').val("1");
                            $.connection.hub.disconnected(function () {
                                setTimeout(function () {
                                    $.connection.hub.start();
                                }, 5000);
                            });
                            $.get("/ClaimForm/DeactiveAlert", {}, function (data2) {

                                if ("@Session["ClaimForm_Approved"]" != "") {
                                    ClaimForm_Approv = parseInt("@Session["ClaimForm_Approved"]");
                                    if (ClaimForm_Approv == 1) {
                                        var sound = new Audio('/Media/alert.mp3');
                                        sound.autoplay = true;
                                        sound.muted = false;
                                        sound.play();
                                        setTimeout(function () {
                                            snackbar.classList.add('isShown');
                                            $('#CardNumbersnackbar').text(model.CardNumber)
                                            $('#Claimformsnackbar').text(model.ClaimFormNum)
                                            setTimeout(hideSnackbar, 5000);

                                            $('#trigger').val("0");
                                            setBadgeCount('NotifactionCount', data2);
                                        }, 100);
                                    }
                                }

                            })
                        }
                    });
                }
            });
        }
        catch (err) { }
    }

    function getData2() {
        try {

            $.ajax({
                url: $("#Get1").val(),
                type: 'GET',
                datatype: 'json',
                success: function (data) {

                    var provid = 0;
                    var branchid = 0;
                    if ("@Session["providerid"]" != "" && "@Session["BranchID"]" != "") {
                        provid = parseInt("@Session["providerid"]");
                        branchid = parseInt("@Session["BranchID"]");
                    }
                    var ApprovePage = 0;
                    var ApprovePage1 = 0;
                    var ApprovePage2 = 0;

                    if ("@Session["ClaimForm_Approved"]" != "" || "@Session["Approval"]" != "" || "@Session["Doctor_ClaimForm"]" != "") {
                        ApprovePage = parseInt("@Session["ClaimForm_Approved"]");
                        ApprovePage1 = parseInt("@Session["Approval"]");
                        ApprovePage2 = parseInt("@Session["Doctor_ClaimForm"]");
                    }

                    $.get("/ClaimForm/getcountallertSmartCard", {}, function (data1) {
                        setBadgeCount('MemberSmartCardRequestsCount', data1);
                    });
                    $.each(data.listCus, function (i, model) {

                        if ((provid == model.ProviderID) && (branchid == model.BranchID) && (model.CardNumber != "0") && ($('#trigger1').val() == "0") && (ApprovePage == 1 || ApprovePage1 == 1 || ApprovePage2 == 1)) {
                            $('#trigger1').val("1");
                            $.connection.hub.disconnected(function () {
                                setTimeout(function () {
                                    $.connection.hub.start();
                                }, 5000);
                            });

                            $.get("/ClaimForm/DeactiveAlertSmartCard", {}, function (data2) {

                                var sound = new Audio('/Media/alert.mp3');
                                sound.play();
                                setTimeout(function () {
                                    snackbarMember.classList.add('isShown');
                                    $('#CardNumbersnackbarMember').text(model.CardNumber)
                                    setTimeout(hideSnackbard1, 5000);

                                    $('#trigger1').val("0");
                                    setBadgeCount('MemberSmartCardRequestsCount', data2);
                                }, 100);

                            })
                        }
                    });
                }
            });
        }
        catch (err) { }
    }
</script>

<script>
    function refresh() {

        $.ajax({
            type: "POST",
            url: "/ClaimForm/CheckIfSessionValid",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (r) {
                if (r == "False") {
                    window.open('@Url.Action("login", "ClaimForm")', '_self');
                }
                else {
                    setTimeout(refresh, 5000);
                }
            }
        });

    }

    setTimeout(refresh, 1000);
</script>

<style>
    .checkbox-wrapper-19 {
        box-sizing: border-box;
        --background-color: #fff;
        --checkbox-height: 25px;
    }

    @@-moz-keyframes dothabottomcheck-19 {
        0% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) / 2);
        }
    }

    @@-webkit-keyframes dothabottomcheck-19 {
        0% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) / 2);
        }
    }

    @@keyframes dothabottomcheck-19 {
        0% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) / 2);
        }
    }

    @@keyframes dothatopcheck-19 {
        0% {
            height: 0;
        }

        50% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) * 1.2);
        }
    }

    @@-webkit-keyframes dothatopcheck-19 {
        0% {
            height: 0;
        }

        50% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) * 1.2);
        }
    }

    @@-moz-keyframes dothatopcheck-19 {
        0% {
            height: 0;
        }

        50% {
            height: 0;
        }

        100% {
            height: calc(var(--checkbox-height) * 1.2);
        }
    }

    .checkbox-wrapper-19 input[type=checkbox] {
        display: none;
    }

    .checkbox-wrapper-19 .check-box {
        height: var(--checkbox-height);
        width: var(--checkbox-height);
        background-color: transparent;
        border: calc(var(--checkbox-height) * .1) solid #000;
        border-radius: 5px;
        position: relative;
        display: inline-block;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-sizing: border-box;
        -moz-transition: border-color ease 0.2s;
        -o-transition: border-color ease 0.2s;
        -webkit-transition: border-color ease 0.2s;
        transition: border-color ease 0.2s;
        cursor: pointer;
    }

        .checkbox-wrapper-19 .check-box::before,
        .checkbox-wrapper-19 .check-box::after {
            -moz-box-sizing: border-box;
            -webkit-box-sizing: border-box;
            box-sizing: border-box;
            position: absolute;
            height: 0;
            width: calc(var(--checkbox-height) * .2);
            background-color: #34b93d;
            display: inline-block;
            -moz-transform-origin: left top;
            -ms-transform-origin: left top;
            -o-transform-origin: left top;
            -webkit-transform-origin: left top;
            transform-origin: left top;
            border-radius: 5px;
            content: " ";
            -webkit-transition: opacity ease 0.5;
            -moz-transition: opacity ease 0.5;
            transition: opacity ease 0.5;
        }

        .checkbox-wrapper-19 .check-box::before {
            top: calc(var(--checkbox-height) * .72);
            left: calc(var(--checkbox-height) * .41);
            box-shadow: 0 0 0 calc(var(--checkbox-height) * .05) var(--background-color);
            -moz-transform: rotate(-135deg);
            -ms-transform: rotate(-135deg);
            -o-transform: rotate(-135deg);
            -webkit-transform: rotate(-135deg);
            transform: rotate(-135deg);
        }

        .checkbox-wrapper-19 .check-box::after {
            top: calc(var(--checkbox-height) * .37);
            left: calc(var(--checkbox-height) * .05);
            -moz-transform: rotate(-45deg);
            -ms-transform: rotate(-45deg);
            -o-transform: rotate(-45deg);
            -webkit-transform: rotate(-45deg);
            transform: rotate(-45deg);
        }

        .checkbox-wrapper-19 input[type=checkbox]:checked + .check-box,
        .checkbox-wrapper-19 .check-box.checked {
            border-color: #34b93d;
        }

            .checkbox-wrapper-19 input[type=checkbox]:checked + .check-box::after,
            .checkbox-wrapper-19 .check-box.checked::after {
                height: calc(var(--checkbox-height) / 2);
                -moz-animation: dothabottomcheck-19 0.2s ease 0s forwards;
                -o-animation: dothabottomcheck-19 0.2s ease 0s forwards;
                -webkit-animation: dothabottomcheck-19 0.2s ease 0s forwards;
                animation: dothabottomcheck-19 0.2s ease 0s forwards;
            }

            .checkbox-wrapper-19 input[type=checkbox]:checked + .check-box::before,
            .checkbox-wrapper-19 .check-box.checked::before {
                height: calc(var(--checkbox-height) * 1.2);
                -moz-animation: dothatopcheck-19 0.4s ease 0s forwards;
                -o-animation: dothatopcheck-19 0.4s ease 0s forwards;
                -webkit-animation: dothatopcheck-19 0.4s ease 0s forwards;
                animation: dothatopcheck-19 0.4s ease 0s forwards;
            }
</style>