@{
    ViewBag.Title = "Messanger";
}
@*<h2>Messanger</h2>*@

@*@Scripts.Render("~/bundles/jquery")*@
@Scripts.Render("~/bundles/bootstrap")
<script src="~/Scripts/jquery.signalR-2.4.3.min.js"></script>
<script src="~/signalr/hubs" type="text/javascript"></script>
@*<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment-with-locales.min.js"></script>*@
<script type="text/javascript" src="~/Scripts/moment-with-locales.min.js"></script>

@Html.Hidden("Get", Url.Action("Get", "Customer"))

@Html.Hidden("Getmessages", Url.Action("Getmessages", "Customer"))
@*<input type="hidden" id="providerID" value="@ViewBag.providerID" />
    <input type="hidden" id="BranchID" value="@ViewBag.BranchID" />*@
<input type="hidden" id="trigger" value="0" />


<style>
    .stretch-card > .card {
        width: 100%;
        min-width: 100%
    }

    body {
        background-color: #f9f9fa
    }

    .flex {
        -webkit-box-flex: 1;
        -ms-flex: 1 1 auto;
        flex: 1 1 auto
    }



    .padding {
        padding: 3rem
    }

    .box.box-warning {
        border-top-color: teal;
    }

    .box {
        position: relative;
        border-radius: 33px;
        background: #ffffff;
        border-top: 3px solid #d2d6de;
        margin-bottom: 2px;
        width: 100%;
        box-shadow: 1px 1px 1px 1px rgba(0,0,0,0.1);
    }

    .box-header.with-border {
        border-bottom: 1px solid #f4f4f4
    }

    .box-header.with-border {
        border-bottom: 1px solid #f4f4f4;
    }

    .box-header {
        color: #444;
        display: block;
        padding: 10px;
        position: relative;
    }

        .box-header:before, .box-body:before, .box-footer:before, .box-header:after, .box-body:after, .box-footer:after {
            content: " ";
            display: table;
        }

    .box-header {
        color: #444;
        display: block;
        padding: 10px;
        position: relative
    }

        .box-header > .fa, .box-header > .glyphicon, .box-header > .ion, .box-header .box-title {
            display: inline-block;
            font-size: 22px;
            margin: 0;
            line-height: 1;
        }

        .box-header > .box-tools {
            position: absolute;
            right: 10px;
            top: 5px;
        }

            .box-header > .box-tools [data-toggle="tooltip"] {
                position: relative;
            }

    .bg-yellow, .callout.callout-warning, .alert-warning, .label-warning, .modal-warning .modal-body {
        background-color: #f39c12 !important;
    }

    .bg-yellow {
        color: #fff !important;
    }

    .btn {
        border-radius: 3px;
        -webkit-box-shadow: none;
        box-shadow: none;
        border: 1px solid transparent;
    }

    .btn-box-tool {
        padding: 5px;
        font-size: 14px;
        background: transparent;
        color: #97a0b3;
    }

    .direct-chat .box-body {
        border-bottom-right-radius: 0;
        border-bottom-left-radius: 0;
        position: relative;
        overflow-x: hidden;
        padding: 0;
    }

    .box-body {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 3px;
        border-bottom-left-radius: 3px;
        padding: 10px;
    }

        .box-header:before, .box-body:before, .box-footer:before, .box-header:after, .box-body:after, .box-footer:after {
            content: " ";
            display: table;
        }

    .direct-chat-messages {
        -webkit-transform: translate(0, 0);
        -ms-transform: translate(0, 0);
        -o-transform: translate(0, 0);
        transform: translate(0, 0);
        padding: 10px;
        height: 550px;
        overflow: auto;
    }

    .direct-chat-messages, .direct-chat-contacts {
        -webkit-transition: -webkit-transform .5s ease-in-out;
        -moz-transition: -moz-transform .5s ease-in-out;
        -o-transition: -o-transform .5s ease-in-out;
        transition: transform .5s ease-in-out;
    }



    .direct-chat-msg {
        margin-bottom: 10px;
    }

    .direct-chat-msg, .direct-chat-text {
        display: block;
    }

    .direct-chat-info {
        display: block;
        margin-bottom: 2px;
        font-size: 12px;
    }

    .direct-chat-timestamp {
        color: #999;
    }

    .btn-group-vertical > .btn-group:after, .btn-group-vertical > .btn-group:before, .btn-toolbar:after, .btn-toolbar:before, .clearfix:after, .clearfix:before, .container-fluid:after, .container-fluid:before, .container:after, .container:before, .dl-horizontal dd:after, .dl-horizontal dd:before, .form-horizontal .form-group:after, .form-horizontal .form-group:before, .modal-footer:after, .modal-footer:before, .modal-header:after, .modal-header:before, .nav:after, .nav:before, .navbar-collapse:after, .navbar-collapse:before, .navbar-header:after, .navbar-header:before, .navbar:after, .navbar:before, .pager:after, .pager:before, .panel-body:after, .panel-body:before, .row:after, .row:before {
        display: table;
        content: " ";
    }

    .direct-chat-img {
        border-radius: 50%;
        float: left;
        width: 40px;
        height: 40px;
    }

    .direct-chat-text {
        border-radius: 10px;
        position: relative;
        padding: 6px 12px;
        background: #d2d6de;
        border: 3px solid #d2d6de;
        margin: 5px 0 0 50px;
        color: #444;
        font-size: 18px;
    }

    .direct-chat-msg, .direct-chat-text {
        display: block;
    }

        .direct-chat-text:before {
            border-width: 6px;
            margin-top: -6px;
        }

        .direct-chat-text:after, .direct-chat-text:before {
            position: absolute;
            right: 100%;
            top: 15px;
            border: solid transparent;
            border-right-color: #d2d6de;
            content: ' ';
            height: 0;
            width: 0;
            pointer-events: none;
        }

        .direct-chat-text:after {
            border-width: 5px;
            margin-top: -5px;
        }

        .direct-chat-text:after, .direct-chat-text:before {
            position: absolute;
            right: 100%;
            top: 15px;
            border: solid transparent;
            border-right-color: #d2d6de;
            content: ' ';
            height: 0;
            width: 0;
            pointer-events: none;
        }

    :after, :before {
        -webkit-box-sizing: border-box;
        -moz-box-sizing: border-box;
        box-sizing: border-box;
    }

    .direct-chat-msg:after {
        clear: both;
    }

    .direct-chat-msg:after {
        content: " ";
        display: table;
    }

    .direct-chat-info {
        display: block;
        margin-bottom: 2px;
        font-size: 12px;
    }

    .right .direct-chat-img {
        float: right;
    }

    .direct-chat-warning .right > .direct-chat-text {
        background: teal;
        border-color: teal;
        color: #fff;
    }

    .right .direct-chat-text {
        margin-right: 50px;
        margin-left: 0;
    }

    .box-footer {
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        border-bottom-right-radius: 30px;
        border-bottom-left-radius: 30px;
        border-top: 1px solid #f4f4f4;
        padding: 10px;
        background-color: #fff;
    }

        .box-header:before, .box-body:before, .box-footer:before, .box-header:after, .box-body:after, .box-footer:after {
            content: " ";
            display: table;
        }


    .input-group-btn {
        position: relative;
        font-size: 0;
        white-space: nowrap;
    }

        .input-group-btn:last-child > .btn, .input-group-btn:last-child > .btn-group {
            z-index: 2;
            margin-left: -1px;
        }

    .btn-warning {
        color: #fff;
        background-color: teal;
        border-color: teal;
    }
</style>






<div class="page-content page-container" id="page-content">
    <div class="padding">
        <div class="row container d-flex justify-content-center">
            <div class="col-md-12">

                <div class="box box-warning direct-chat direct-chat-warning">
                    <div class="box-header with-border">
                        <h3 class="box-title">Chat Messages</h3>

                        @*<div class="box-tools pull-right">
                                <span data-toggle="tooltip" title="" class="badge bg-yellow" data-original-title="3 New Messages">20</span>
                                <button type="button" class="btn btn-box-tool" data-widget="collapse">
                                    <i class="fa fa-minus"></i>
                                </button>
                                <button type="button" class="btn btn-box-tool" data-toggle="tooltip" title="" data-widget="chat-pane-toggle" data-original-title="Contacts">
                                    <i class="fa fa-comments"></i>
                                </button>
                                <button type="button" class="btn btn-box-tool" data-widget="remove">
                                    <i class="fa fa-times"></i>
                                </button>
                            </div>*@
                    </div>

                    <div class="box-body">

                        <div class="direct-chat-messages" id="Chatmessages">

                            @*<div class="direct-chat-msg">
                                    <div class="direct-chat-info clearfix">
                                        <span class="direct-chat-name pull-left">Timona Siera</span>
                                        <span class="direct-chat-timestamp pull-right">23 Jan 2:00 pm</span>
                                    </div>

                                    <img class="direct-chat-img" src="https://img.icons8.com/color/36/000000/administrator-male.png" alt="message user image">

                                    <div class="direct-chat-text" style="text-align:left">
                                        For what reason would it be advisable for me to think about business content?
                                    </div>

                                </div>

                                <div class="direct-chat-msg right">
                                    <div class="direct-chat-info clearfix">
                                        <span class="direct-chat-name pull-right">Sarah Bullock</span>
                                        <span class="direct-chat-timestamp pull-left">23 Jan 2:05 pm</span>
                                    </div>

                                    <img class="direct-chat-img" src="https://img.icons8.com/office/36/000000/person-female.png" alt="message user image">

                                    <div class="direct-chat-text" style="text-align:right">
                                        Thank you for your believe in our supports
                                    </div>

                                </div>



                                <div class="direct-chat-msg">
                                    <div class="direct-chat-info clearfix">
                                        <span class="direct-chat-name pull-left">Timona Siera</span>
                                        <span class="direct-chat-timestamp pull-right">23 Jan 5:37 pm</span>
                                    </div>

                                    <img class="direct-chat-img" src="https://img.icons8.com/color/36/000000/administrator-male.png" alt="message user image">

                                    <div class="direct-chat-text" style="text-align:left">
                                        For what reason would it be advisable for me to think about business content?
                                    </div>

                                </div>

                                <div class="direct-chat-msg right">
                                    <div class="direct-chat-info clearfix">
                                        <span class="direct-chat-name pull-right">Sarah Bullock</span>
                                        <span class="direct-chat-timestamp pull-left">23 Jan 6:10 pm</span>
                                    </div>

                                    <img class="direct-chat-img" src="https://img.icons8.com/office/36/000000/person-female.png" alt="message user image">

                                    <div class="direct-chat-text" style="text-align:right">
                                        I would love to.
                                    </div>

                                </div>*@


                        </div>

                    </div>

                    <div class="box-footer">
                        @* <form action="#" method="post">*@
                        <div class="input-group">
                            <input type="text" id="message" style="text-align:right" name="message" placeholder="Type Message ..." class="form-control">
                            <span class="input-group-btn">
                                <button type="button" id="send" style="background:teal;color:white" class="btn btn-flat">Send</button>
                            </span>
                        </div>
                        @*</form>*@
                    </div>

                </div>

            </div>
        </div>

    </div>

</div>




@*<br />*@
@*<br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />
    <br />*@
@*<table class="table">
        <thead>
            <tr>
                <th>Id</th>
                <th>Customer Id</th>
                <th>Customer Name</th>
                <th>Customer Name</th>
                <th>Customer Name</th>
                <th>Customer Name</th>
                <th>Customer Name</th>
            </tr>
        </thead>
        <tbody id="tblInfo"></tbody>
    </table>*@

<script>
    $("body").on("click", "#send", function () {

        $.get("/ClaimForm/ADDMessage", { message: $('#message').val() }, function (data) {

            $("#message").val("");
            var Date = moment(data[2]);
            var value = "@ViewBag.image";
            //alert(value);
            var content = "<div class='direct-chat-msg'>  <div class='direct-chat-info clearfix'> <span class='direct-chat-name pull-left'>"
                + data[0] + "( " + data[1] + " )</span>" + "<span class='direct-chat-timestamp pull-right' >" + Date.format("DD-MM-YYYY HH:mm:ss")
                + " </span> </div>  <img class='direct-chat-img' src='" + value+"' alt = 'message user image' >" +
                "<div class='direct-chat-text' style='text-align:left'>" + data[3] + " </div></div>";

            $('#Chatmessages').append(content);
            var objDiv = document.getElementById("Chatmessages");
            objDiv.scrollTop = objDiv.scrollHeight;
        })

    });
</script>
<script type="text/javascript">
    document.addEventListener("visibilitychange", () => {
        if (document.hidden) {
            //$.connection.hub.disconnect();
            // $.connection.hub.disconnected(function () {
            //});
            $.connection.hub.stop();

             //console.log("tab out")
            // tab is changed
        } else {
            //$.connection.hub.connect();
            $.connection.hub.start().done(function () {
                 //console.log("connection started")
                //notifications.onconn();  
                getData();
                getData1();
            }).fail(function (e) {
                //console.log(e);
            });
            //console.log("tab in")

            // tab is active
        }
    });

    function sleep(ms) {
        return new Promise(
            resolve => setTimeout(resolve, ms)
        );


    }
    $(function () {
        // Proxy created on the fly
        var cus = $.connection.cusHub;
        //var cus1 = $.connection.cusHub1;
        //console.log(cus)
        // Declare a function on the job hub so the server can invoke it
        cus.client.displayCustomer = function () {
            // async function a() {
            getData();
            //   await sleep(2000);
            //  getData1();
            //}
            //a();

            //getData();
            //getData1();
        };
        cus.client.data = function () {
            //async function a() {
            //    getData();
            //    await sleep(2000);
            getData1();
            //}
            //a();

            //getData();
            //getData1();
        };
        // Start the connection
        $.connection.hub.start();
        getData();
        getData1();
        //async function aa() {
        //    getData();
        //    await sleep(2000);
        //    getData1();
        //}
        //aa();

    });

    function getData1() {
        try {

        //var $tbl = $('#tblInfo');
        $.ajax({
            url: /*"/Customer/Send_to_payy"*/ $("#Getmessages").val(),
            type: 'GET',
            datatype: 'json',
            success: function (data1) {

                @*var provid = 0;
                if ("@Session["providerid"]" != "") {
                     provid = parseInt("@Session["providerid"]");
                }*@
                //alert(provid);

                @*alert("@Session["providerid"]");
                alert(data.ProviderID);*@

                //$tbl.empty();
                $.get("/ClaimForm/showallmessage", { /*Provider_id: $('#providerID').val(), Branch_id: $('#BranchID').val() */}, function (data) {

                });
                $.get("/ClaimForm/getcountmessage", {/* Provider_id: $('#providerID').val(), Branch_id: $('#BranchID').val()*/}, function (data) {
                    //if (data == 0) {
                        $('#MesaageCount').removeAttr("data-count");

                    //}
                    //else {
                    //    $('#MesaageCount').attr("data-count", data);
                    //}
                   // console.log(data);
                });

                $('#Chatmessages').empty();

                $.each(data1.listCus, function (i, model) {

                    //if (provid == model.ProviderID) {
                    //    alert(model.ClaimFormNum);
                    //}


                    var Date = moment(model.MessageDateTime);
                    if (model.IsProvider == true) {
                        var value = "@ViewBag.image";
                        //alert(value);
                        var content = "<div class='direct-chat-msg'>  <div class='direct-chat-info clearfix'> <span class='direct-chat-name pull-left'>"
                            + model.ProviderName + "( " + model.BranchName + " )</span>" + "<span class='direct-chat-timestamp pull-right' >" + Date.format("DD-MM-YYYY HH:mm:ss")
                            + " </span> </div>  <img class='direct-chat-img' src='" + value+"' alt = 'message user image' >" +
                            "<div class='direct-chat-text' style='text-align:left'>" + model.Message + " </div></div>";

                        $('#Chatmessages').append(content);
                    }
                    else {
                        var content1 = "<div class='direct-chat-msg right'>  <div class='direct-chat-info clearfix'> <span class='direct-chat-name pull-right'>"
                            + model.CMCName + "</span>" + "<span class='direct-chat-timestamp pull-left' >" + Date.format("DD-MM-YYYY HH:mm:ss")
                            + " </span> </div>  <img class='direct-chat-img' src='/Images/administratormale.png' alt = 'message user image' >" +
                            "<div class='direct-chat-text' style='text-align:right'>" + model.Message + " </div></div>";

                        $('#Chatmessages').append(content1);
                    }
                    //src = 'https://img.icons8.com/color/36/000000/administrator-male.png'

                    //$tbl.append
                    //    (
                    //    '<tr>' +
                    //        '<td>' + model.ProviderName + '</td>' +
                    //        '<td>' + model.BranchName + '</td>' +
                    //        '<td>' + model.CMCName + '</td>' +
                    //        '<td>' + model.Message + '</td>' +
                    //        '<td>' + Date.format("DD-MM-YYYY HH:mm:ss") + '</td>' +
                    //        '<td>' + model.IsProvider + '</td>' +
                    //        '<td>' + model.IsCMC + '</td>' +
                    //    '<tr>'
                    //    );
                });
                var objDiv = document.getElementById("Chatmessages");
                objDiv.scrollTop = objDiv.scrollHeight;
            }
            });
        }
        catch (err) {
        }
    }
    function getData() {
        try {

        $.ajax({
            url: /*"/Customer/Send_to_payy"*/ $("#Get").val(),
            type: 'GET',
            datatype: 'json',
            success: function (data) {

                var provid = 0;
                var branchid = 0;
                if ("@Session["providerid"]" != "" &&"@Session["BranchID"]" != "") {
                     provid = parseInt("@Session["providerid"]");
                     branchid = parseInt("@Session["BranchID"]");
                }
                  var ApprovePage = 0;

                if ("@Session["ClaimForm_Approved"]" != "" ) {
                     ApprovePage = parseInt("@Session["ClaimForm_Approved"]");
                }
                //alert(provid);
                //alert(branchid);

                @*alert("@Session["providerid"]");
                alert(data.ProviderID);*@

                //$tbl.empty();
                $.get("/ClaimForm/getcountallert", {}, function (data1) {
                    if (data1 == 0) {
                        $('#NotifactionCount').removeAttr("data-count");

                    }
                    else {
                        $('#NotifactionCount').attr("data-count", data1);
                    }
                });

                $.each(data.listCus, function (i, model) {

                    //if ((provid == model.ProviderID) && (branchid == model.BranchID)) {
                    //}
                    if ((provid == model.ProviderID) && (branchid == model.BranchID) && (model.CardNumber != "0") && (model.ClaimFormNum != 0) && ($('#trigger').val() == "0") && (ApprovePage == 1)) {
                        $('#trigger').val("1");

                        $.connection.hub.disconnected(function () {
                            setTimeout(function () {
                                $.connection.hub.start();
                            }, 5000); // Restart connection after 5 seconds.
                        });
                        $.get("/ClaimForm/DeactiveAlert", {}, function (data2) {

                               if ("@Session["ClaimForm_Approved"]"!="") {
                                    ClaimForm_Approv = parseInt("@Session["ClaimForm_Approved"]");
                                   if (ClaimForm_Approv == 1) {
                                       var sound = new Audio('/Media/alert.mp3');
                                       sound.autoplay = true;
                                       sound.muted = false;
                                       sound.play();
                                       setTimeout(function () {
                                           snackbar.classList.add('isShown');
                                           $('#CardNumbersnackbar').text(model.CardNumber)
                                           $('#Claimformsnackbar').text(model.ClaimFormNum)
                                           setTimeout(hideSnackbar, 5000);
                                    @*var result = confirm("You Currently Reiceve Approval From CMC \n For Card Number is : " + model.CardNumber + "\n Claim Form Is :" + model.ClaimFormNum + " \n Are you Sure you want to Go ClaimForm Approved ?");
                                        if (result == true) {
                                                    window.open('@Url.Action("ProviderClaimFormApproved", "ClaimForm")', '_self');
                                       }
                                       else {

                                       }*@
                                       $('#trigger').val("0");
                                           if (data2 == 0) {
                                           $('#NotifactionCount').removeAttr("data-count");

                                       }
                                       else {
                                               $('#NotifactionCount').attr("data-count", data2);
                                           }
                                       }, 100);
                                }
                                 }

                        })
                        //alert("You Currently Reiceve Approval From CMC \n For Card Number is : " + model.CardNumber +"\n Claim Form Is :"+model.ClaimFormNum);

                    }
                    //$tbl.append
                    //    (
                    //    '<tr>' +
                    //        '<td>' + model.ClaimFormNum + '</td>' +
                    //        '<td>' + model.CardNumber + '</td>' +
                    //        '<td>' + model.ProviderID + '</td>' +
                    //        '<td>' + model.BranchID + '</td>' +
                    //    '<tr>'
                    //    );
                });
            }
            });
        }
        catch (err) {
        }
    }

</script>

<script>


    function refresh() {

              $.ajax({
                        type: "POST",
                        url: "/ClaimForm/CheckIfSessionValid",
                        //data: JSON.stringify(Claims_Services),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (r) {
                            if (r == "False") {
                                window.open('@Url.Action("login", "ClaimForm")', '_self');
                            }
                            else {
                                setTimeout(refresh, 5000);
                                 }
                        }
        });

    }

    setTimeout(refresh, 1000);
</script>



@*<script type="text/javascript">
        $(function () {

            // Proxy created on the fly
            var cus = $.connection.cusHub;

            // Declare a function on the job hub so the server can invoke it
            cus.client.displayCustomer = function () {
                getData1();
            };

            // Start the connection
            $.connection.hub.start();
            getData1();
        });

        function getData1() {
            //var $tbl = $('#tblInfo');
            $.ajax({
                url: /*"/Customer/Send_to_payy"*/ $("#Getmessages").val(),
                type: 'GET',
                datatype: 'json',
                success: function (data) {

                    @*var provid = 0;
                    if ("@Session["providerid"]" != "") {
                         provid = parseInt("@Session["providerid"]");
                    }@
                    //alert(provid);

                    @*alert("@Session["providerid"]");
                    alert(data.ProviderID);@

                    //$tbl.empty();
                    $.get("/ClaimForm/showallmessage", { /*Provider_id: $('#providerID').val(), Branch_id: $('#BranchID').val() */}, function (data) {

                    });
                    $.get("/ClaimForm/getcountmessage", {/* Provider_id: $('#providerID').val(), Branch_id: $('#BranchID').val()*/}, function (data) {
                        //if (data == 0) {
                            $('#MesaageCount').removeAttr("data-count");

                        //}
                        //else {
                        //    $('#MesaageCount').attr("data-count", data);
                        //}
                       // console.log(data);
                    });

                    $('#Chatmessages').empty();

                    $.each(data.listCus, function (i, model) {

                        //if (provid == model.ProviderID) {
                        //    alert(model.ClaimFormNum);
                        //}


                        var Date = moment(model.MessageDateTime);
                        if (model.IsProvider == true) {
                            var value = "@ViewBag.image";
                            //alert(value);
                            var content = "<div class='direct-chat-msg'>  <div class='direct-chat-info clearfix'> <span class='direct-chat-name pull-left'>"
                                + model.ProviderName + "( " + model.BranchName + " )</span>" + "<span class='direct-chat-timestamp pull-right' >" + Date.format("DD-MM-YYYY HH:mm:ss")
                                + " </span> </div>  <img class='direct-chat-img' src='" + value+"' alt = 'message user image' >" +
                                "<div class='direct-chat-text' style='text-align:left'>" + model.Message + " </div></div>";

                            $('#Chatmessages').append(content);
                        }
                        else {
                            var content1 = "<div class='direct-chat-msg right'>  <div class='direct-chat-info clearfix'> <span class='direct-chat-name pull-right'>"
                                + model.CMCName + "</span>" + "<span class='direct-chat-timestamp pull-left' >" + Date.format("DD-MM-YYYY HH:mm:ss")
                                + " </span> </div>  <img class='direct-chat-img' src='https://img.icons8.com/color/36/000000/administrator-male.png' alt = 'message user image' >" +
                                "<div class='direct-chat-text' style='text-align:right'>" + model.Message + " </div></div>";

                            $('#Chatmessages').append(content1);
                        }
                        //$tbl.append
                        //    (
                        //    '<tr>' +
                        //        '<td>' + model.ProviderName + '</td>' +
                        //        '<td>' + model.BranchName + '</td>' +
                        //        '<td>' + model.CMCName + '</td>' +
                        //        '<td>' + model.Message + '</td>' +
                        //        '<td>' + Date.format("DD-MM-YYYY HH:mm:ss") + '</td>' +
                        //        '<td>' + model.IsProvider + '</td>' +
                        //        '<td>' + model.IsCMC + '</td>' +
                        //    '<tr>'
                        //    );
                    });
                    var objDiv = document.getElementById("Chatmessages");
                    objDiv.scrollTop = objDiv.scrollHeight;
                }
            });
        }

    </script>*@