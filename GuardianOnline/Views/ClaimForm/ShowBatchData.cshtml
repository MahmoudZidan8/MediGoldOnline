
@{
    ViewBag.Title = "ShowBatchData";
}

<script type="text/javascript" src="~/Scripts/moment-with-locales.min.js"></script>

<script type="text/javascript" src="~/Scripts/bootstrap.bundle.min.js"></script>
<link rel="stylesheet" href="~/Content/bootstrapbundle.min.css">
<script src="~/Scripts/bootstrap.min.js"></script>
@*<script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>*@

<script type="text/javascript" src="~/Scripts/dataTables.buttons.min.js"></script>
<script type="text/javascript" src="~/Scripts/jszip.min.js"></script>
@*<script type="text/javascript" src="~/Scripts/pdfmake.min.js"></script>*@
<script type="text/javascript" src="~/Scripts/vfs_fonts.js"></script>
<script type="text/javascript" src="~/Scripts/buttons.html5.min.js"></script>
<script type="text/javascript" src="~/Scripts/buttons.print.min.js"></script>
<link rel="stylesheet" href="~/Content/buttons.dataTables.min.css">

@*<link href="https://cdn.datatables.net/buttons/2.2.3/css/buttons.dataTables.min.css" rel="stylesheet" />*@
<link rel="stylesheet" href="~/Content/buttons.dataTables.min.css">


@*<script src="https://cdn.datatables.net/plug-ins/1.10.11/sorting/date-eu.js" type="text/javascript"></script>*@
<script type="text/javascript" src="~/Scripts/date-eu.js"></script>



<style>
    /*body {
        margin: 0;
        padding: 0;
        background: #262626;
    }*/
    #backring1 {
        background-color: darkgray;
    }

    .ring1 {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%,-50%);
        width: 150px;
        height: 150px;
        background: transparent;
        border: 3px solid /*#3c3c3c*/ #9ac3b8;
        border-radius: 50%;
        text-align: center;
        line-height: 150px;
        font-family: sans-serif;
        font-size: 20px;
        color: /*#928d36*/ #fff000;
        letter-spacing: 4px;
        text-transform: uppercase;
        text-shadow: 0 0 10px #fff000;
        box-shadow: 0 0 20px rgba(0,0,0,.5);
        background-color: #11395c;
    }

        .ring1:before {
            content: '';
            position: absolute;
            top: 0px;
            left: 0px;
            width: 100%;
            height: 100%;
            border: 3px solid transparent;
            border-top: 3px solid #fff000;
            border-right: 3px solid #fff000;
            box-shadow: 0 0 1em white, 0 0 0 1000vw #e0dedeb5;
            border-radius: 50%;
            animation: animateC1 2s linear infinite;
        }

    spana1 {
        display: block;
        position: absolute;
        top: calc(50% - 2px);
        left: 50%;
        width: 50%;
        height: 4px;
        background: transparent;
        transform-origin: left;
        animation: animate1 2s linear infinite;
    }

        spana1:before {
            content: '';
            position: absolute;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: #fff000;
            top: -6px;
            right: -8px;
            box-shadow: 0 0 20px #fff000;
        }

    @@keyframes animateC1 {
        0% {
            transform: rotate(0deg);
        }

        100% {
            transform: rotate(360deg);
        }
    }

    @@keyframes animate1 {
        0% {
            transform: rotate(45deg);
        }

        100% {
            transform: rotate(405deg);
        }
    }
</style>
<style>
    td.details-control {
        background: url('/Images/details_open.png') no-repeat center center;
        cursor: pointer;
    }

    tr.shown td.details-control {
        background: url('/Images/details_close.png') no-repeat center center;
    }
</style>
<style>

    #link {
        text-decoration: none;
        display: inline-block;
        padding: 8px 16px;
    }

        #link:hover {
            background-color: #ddd;
            color: black;
        }

    /*.previous {
        background-color: #f1f1f1;
        color: black;
    }

        .previous:hover {
            background-color: #ddd;
            color: black;
        }

    .next {
        background-color: #04AA6D;
        color: white;
    }*/

    .round {
        background-color: teal;
        color: white;
        border-radius: 50%;
    }
</style>
<style>
    /*body {
            background-image:url('../Images/login.jpg');
        }*/
    /*table1 {
        border: 1px solid black;
    }*/
    table.table1 {
        border: 1px solid #ccc;
        border-collapse: collapse;
        background-color: #fff;
    }

        table.table1 th {
            background-color: teal;
            color: white;
            font-weight: bold;
        }

        table.table1 th, table.table1 td {
            padding: 5px;
            border: 1px solid #ccc;
        }

        table.table1, table.table1 table td {
            border: 0px solid #ccc;
        }

    body.table789 {
        font-family: Arial;
        font-size: 10pt;
    }

    table.table789 {
        border: 1px solid #ccc;
        border-collapse: collapse;
        background-color: #fff;
    }

        table.table789 th {
            background-color: teal;
            color: white;
            font-weight: bold;
            font-size: 12pt;
        }

        table.table789 th, table.table789 td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 12pt;
        }

        table.table789, table.table789 table td {
            border: 1px solid #ccc;
            font-size: 12pt;
        }

    body.table7899 {
        font-family: Arial;
        font-size: 11pt;
    }

    table.table7899 {
        border: 1px solid #ccc;
        border-collapse: collapse;
        background-color: #fff;
    }

        table.table7899 th {
            background-color: teal;
            color: white;
            font-weight: bold;
            font-size: 12pt;
        }

        table.table7899 th, table.table789 td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 11pt;
            font-weight: bold;
        }

        table.table7899, table.table7899 table td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 10pt;
        }

    body.table78991 {
        font-family: Arial;
        font-size: 9pt;
    }

    table.table78991 {
        border: 1px solid #ccc;
        border-collapse: collapse;
        background-color: #fff;
    }

        table.table78991 th {
            background-color: teal;
            color: white;
            font-weight: bold;
            font-size: 11pt;
        }

        table.table78991 th, table.table789 td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 9pt;
            /*font-weight: bold;*/
        }

        table.table78991, table.table78991 table td {
            padding: 5px;
            border: 1px solid #ccc;
            font-size: 9pt;
            /*font-weight: bold;*/
            /*color: black;*/
        }

    #ProviderBranch {
        max-width: 450px;
    }

    #ClaimForm_Number {
        max-width: 900px;
    }

    #form_number, #Card_number, #Date_Procedure, #Date_symptoms, #ICD_Number {
        font-size: 15px;
    }

    #providerName {
        font-size: 12px;
    }

    legend.scheduler-border {
        width: inherit; /* Or auto */
        padding: 0 10px; /* To give a bit of padding on the left and right */
        border-bottom: none;
    }

    fieldset.scheduler-border {
        border: 1px groove #ddd !important;
        padding: 0 1.4em 1.4em 1.4em !important;
        margin: 0 0 1.5em 0 !important;
        -webkit-box-shadow: 5px 5px 5px 5px #700c0c;
        box-shadow: 1px 1px 1px 1px #700c0c;
    }

    #pagination {
        width: 100%;
        text-align: center;
    }

        #pagination ul li {
            display: inline;
            margin-left: 10px;
        }
</style>
<h2 style="color:teal;text-align:center">Batch Data</h2>
<br />
<fieldset class="scheduler-border" @*style="background-color:lightgray"*@ id="Expended_services">
    <legend class="scheduler-border" style="color:teal">Batch Content Data</legend>
    <div id="claim_services2">
        <br />
        <table class="table1" id="tblApprovals" cellpadding="0" cellspacing="0">
            <thead>
                <tr>
                    <th></th>
                    <th>Claim ID</th>
                    <th>ClaimForm Number</th>
                    <th>Card Number</th>
                    <th>Member Name</th>
                    <th>Procedure Date</th>
                    <th>Contract Amt</th>
                    <th>Deductable Amt</th>
                    <th>Discount Amt</th>
                    <th>Due Amt</th>
                    <th>Requested Amt</th>
                    <th>Difference Amt</th>
                    <th>Branch Name</th>
                </tr>
            </thead>
            @*<tbody></tbody>*@
        </table>
        <br />
    </div>
    <br />
</fieldset>
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />
<br />

<div id="backring1">
    <div class="ring1" id="Loadingg">
        Loading
        <spana1></spana1>
    </div>
</div>




<script>
    //'<th>Claim Item ID</th>' + '<th>Claim ID</th>' +
    function format(d) {
        var result = '<table id="childtable" class="table1" cellpadding="10" cellspacing="0" border="1" style="padding-left: 80px; width:100% ">' +
            '<tr>' + '<th>Service Name</th>' + '<th>Service Qnt</th>' + '<th>Unit Amt</th>' + '<th>Service Amt</th>'
            + '<th>Deduct Amt</th>' + '<th>Discount Amt</th>' + '<th>Due Amt</th>' + '<th>Requested Amt</th>' + '<th>Difference Amt</th>' + '<th>Service Note</th>'  + '</tr>';
        //loop thouth the OderListDetails and add the child items.
        //alert(d);
        //alert(d.OrderListDetails.length);
        for (var i = 0; i < d.OrderListDetails.length; i++) {
            //var child = '<tr><td>' + d.OrderListDetails[i].ClaimitemID + '</td>' +
            //    '<td>' + d.OrderListDetails[i].ClaimID + '</td>' +
            var child = '<tr><td>' + d.OrderListDetails[i].ServiceName + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceQnt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceUnitAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceDeductAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceDiscountAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceDueAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceRequestedAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceDifferenceAmt + '</td>' +
                '<td>' + d.OrderListDetails[i].ServiceNote + '</td>' +
               '</tr>';

            result += child;
        }
        result += '</table>';
        return result;
    }
    $(document).ready(function () {

        var BatchNumber = "@ViewBag.BatchNumberr";
        $.ajax({
            url: "/ClaimForm/GetBatchList",
            data: { Batch_Number: BatchNumber },
            type: "Get",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (data) {
                //console.log("succsss" + data);
                //$.get("/Approvals/GetOrderList", {}, function (data) {
                //alert(data.length);
                //after getting the data, bind the DataTable.
                $("#Loadingg").hide();

                var table = $("#tblApprovals").DataTable({
                    "data": data,
                    "ordering": false,
                    "paging": true,
                    "scrollCollapse": true,
                    "deferRender": true,
                    buttons: [
                        'copy', 'csv', 'excel', /*'pdf',*/ 'print'
                    ],
                    "bInfo": true,
                    //"order": [[7, "asc"]], //or asc
                    "columnDefs": [{ "targets": 4, "type": "date-eu" }],
                    //serverSide: true,
                    //ord: true,
                    //"scrollX": true,

                    "columns": [
                        {
                            "className": 'details-control',
                            "orderable": false,
                            "data": null,
                            "defaultContent": ''
                        },
                        { "data": "ClaimID" },
                        { "data": "ClaimFormNum" },
                        { "data": "CardNumber" },
                        { "data": "MemberName" },
                        { "data": "ProcedureDate" },
                        { "data": "TClaimAmt" },
                        { "data": "TDeductAmt" },
                        { "data": "TDiscountAmt" },
                        { "data": "NetClaimedAmt" },
                        { "data": "TRequestedAmt" },
                        { "data": "TDifferenceAmt" },
                        { "data": "BranchName" },
                        //{   // Checkbox select column
                        //    "data": '<input type="checkbox">',
                        //    "defaultContent": '',
                        //    //"className": 'select-checkbox',
                        //},


                    ],

                    dom: 'Bfrtip',
                    //buttons: [
                    //    'copy', 'csv', 'excel', 'pdf', 'print'
                    //],
                    "order": [[0, 'desc']]

                });

                //}, //Expand/Collapse the nested objects.
                $('#tblApprovals tbody').on('click', 'td.details-control', function () {
                    var table = $("#tblApprovals").DataTable();
                    var tr = $(this).closest('tr');
                    var row = table.row(tr);

                    if (row.child.isShown()) {
                        // This row is already open - close it
                        row.child.hide();
                        tr.removeClass('shown');
                    }
                    else {
                        // Open this row
                        row.child(format(row.data())).show();
                        tr.addClass('shown');
                    }
                });

            },
            error: function (ex) {
                console.log(ex);
            }
        });
    });
</script>



<script>


    function refresh() {

              $.ajax({
                        type: "POST",
                        url: "/ClaimForm/CheckIfSessionValid",
                        //data: JSON.stringify(Claims_Services),
                        contentType: "application/json; charset=utf-8",
                        dataType: "json",
                        success: function (r) {
                            if (r == "False") {
                                window.open('@Url.Action("login", "ClaimForm")', '_self');
                            }
                            else {
                                setTimeout(refresh, 5000);
                                 }
                        }
        });

    }

    setTimeout(refresh, 1000);
</script>


